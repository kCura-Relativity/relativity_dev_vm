##########################################################################
# This script creates a workspaces and install a relativity application. #
# The Data Sampler application imports documents with images and         #
# productions that you specify in the config section in this script.     #
#                                                                        #
#                                                                        #
# How to use:                                                            #
# 1. Point the include section to the directory of your Relativity       #
#    Client Dlls                                                         #
#                                                                        #
# 2. Update the Config section dlls                                      #
#                                                                        #
# 3. Execute the script                                                  #
#                                                                        #
##########################################################################

#############################INCLUDE SECTION##############################
$ScriptDir = Split-Path -parent $MyInvocation.MyCommand.Path
Import-Module $ScriptDir\powershell_functions.ps1 -force
Add-Type -Path "C:\Program Files\kCura Corporation\Relativity\Library\kCura.Relativity.Client.dll"
Add-Type -Path "C:\Program Files\kCura Corporation\Relativity\Library\Relativity.API.dll"
##########################################################################

############################USER CONFIG SECTION###########################
$configFileName = "<%= @config_file_name %>"
$configFileDestinationPath = "<%= @config_file_destination_location %>"
$relativityUsername = "<%= @relativity_username %>"
$relativityPassword = "<%= @relativity_password %>"
$relativityLibraryFolder = "C:\\Program Files\\kCura Corporation\\Relativity\\Library" #Use double backslashes here
$numberOfDocuments = <%= @number_of_documents %>
$importImagesWithDocuments = <%= @import_images_with_documents %>
$importProductionImagesWithDocuments = <%= @import_production_images_with_documents %>
###########################################################################

$configFileLocation = CreateJsonConfigFile $configFileName $configFileDestinationPath $relativityUsername $relativityPassword $relativityLibraryFolder $numberOfDocuments $importImagesWithDocuments $importProductionImagesWithDocuments

if (-Not ([string]::IsNullOrWhitespace($configFileLocation))) {
    #
    #SUCCESS
    exit 0
  }
  else {
    #
    #FAILURE
    exit 1
  }

